2025-09-22 08:38:28,781 INFO Personal recommendation loading
2025-09-22 08:38:28,782 INFO Loading recommendations, type: personal
2025-09-22 08:38:32,293 INFO Loaded
2025-09-22 08:38:32,293 INFO Top-popular recommendation loading
2025-09-22 08:38:32,293 INFO Loading recommendations, type: default
2025-09-22 08:38:32,297 INFO Loaded
2025-09-22 08:38:32,297 INFO Starting
2025-09-22 08:40:39,271 INFO Возвращаем список on-line рекомендаций длиной 100 для пользователя 1127794
2025-09-22 08:40:39,271 INFO - получаем последнее 100 событий пользователя 1127794
2025-09-22 08:40:39,271 INFO - оправляем запрос на сервер on-line рекомендаций http://127.0.0.1:8082 
   c параметрами: {'user_id': 1127794, 'k': 100}
2025-09-22 08:40:39,272 DEBUG Starting new HTTP connection (1): 127.0.0.1:8082
2025-09-22 08:40:39,274 DEBUG http://127.0.0.1:8082 "POST /get?user_id=1127794&k=100 HTTP/1.1" 200 13
2025-09-22 08:40:39,275 INFO - ответ сервера on-line рекомендаций: количество=0, рекомендации - []
2025-09-22 08:40:39,275 INFO Получаем список айтемов, похожих на последние 100, с которыми взаимодействовал пользователь:
2025-09-22 08:41:00,165 INFO Возвращаем список on-line рекомендаций длиной 100 для пользователя 1291250
2025-09-22 08:41:00,165 INFO - получаем последнее 100 событий пользователя 1291250
2025-09-22 08:41:00,165 INFO - оправляем запрос на сервер on-line рекомендаций http://127.0.0.1:8082 
   c параметрами: {'user_id': 1291250, 'k': 100}
2025-09-22 08:41:00,166 DEBUG Starting new HTTP connection (1): 127.0.0.1:8082
2025-09-22 08:41:00,168 DEBUG http://127.0.0.1:8082 "POST /get?user_id=1291250&k=100 HTTP/1.1" 200 13
2025-09-22 08:41:00,168 INFO - ответ сервера on-line рекомендаций: количество=0, рекомендации - []
2025-09-22 08:41:00,168 INFO Получаем список айтемов, похожих на последние 100, с которыми взаимодействовал пользователь:
2025-09-22 08:44:38,348 INFO Stats for recommendations
2025-09-22 08:44:38,348 INFO request_personal_count         0 
2025-09-22 08:44:38,348 INFO request_default_count          0 
2025-09-22 08:45:12,722 INFO Возвращаем список off-line рекомендаций длиной 100 для пользователя 1291250
2025-09-22 08:45:13,451 INFO Off-line рекомендации: [53404, 33311009, 178529, 35505245, 24692821, 795836, 6705392, 32947997, 37384, 45499814, 51241318, 29544272, 39257277, 2758009, 65851540, 328683, 60292250, 17079396, 47627256, 51516485, 18385776, 23559960, 48951, 49961817, 57921154, 54798445, 29611476, 43942453, 34976783, 50685843, 29569939, 148345, 39946957, 56204557, 52380688, 21519270, 732401, 44184116, 137670, 694683, 17902234, 3703085, 48591706, 178495, 52100, 631623, 1710811, 39089632, 9047114, 6679078, 55561798, 37258117, 560473, 595258, 3581309, 24663745, 78426489, 33977439, 50834580, 61565558, 38275100, 580880, 16298499, 42197229, 56920241, 76434671, 628320, 83063895, 28036311, 58515506, 81848875, 25995209, 2278985, 10216, 66322065, 3616433, 34735046, 33308946, 628970, 43052381, 39307896, 44279380, 560468, 57799893, 765627, 56920237, 27032843, 9282507, 630670, 2192826, 62352387, 1710810, 56776952, 43731470, 50821247, 68562711, 75944934, 75642961, 29175370, 68348389]
2025-09-22 08:47:58,515 INFO Возвращаем список on-line рекомендаций длиной 100 для пользователя 1291250
2025-09-22 08:47:58,515 INFO - получаем последнее 100 событий пользователя 1291250
2025-09-22 08:47:58,515 INFO - оправляем запрос на сервер on-line рекомендаций http://127.0.0.1:8082 
   c параметрами: {'user_id': 1291250, 'k': 100}
2025-09-22 08:47:58,516 DEBUG Starting new HTTP connection (1): 127.0.0.1:8082
2025-09-22 08:47:58,518 DEBUG http://127.0.0.1:8082 "POST /get?user_id=1291250&k=100 HTTP/1.1" 200 28
2025-09-22 08:47:58,518 INFO - ответ сервера on-line рекомендаций: количество=2, рекомендации - [34308497, 597280]
2025-09-22 08:47:58,518 INFO Получаем список айтемов, похожих на последние 100, с которыми взаимодействовал пользователь:
2025-09-22 08:47:58,518 INFO - для каждого item_id=34308497 получаем список похожих в item_similar_items
2025-09-22 08:47:58,518 INFO - оправляем запрос на сервер off-line рекомендаций http://127.0.0.1:8081 
   c параметрами: {'item_id': 34308497, 'k': 100}
2025-09-22 08:47:58,519 DEBUG Starting new HTTP connection (1): 127.0.0.1:8081
2025-09-22 08:47:58,527 DEBUG http://127.0.0.1:8081 "POST /similar_items?item_id=34308497&k=100 HTTP/1.1" 200 165
2025-09-22 08:47:58,528 INFO - ответ сервера off-line рекомендаций: количество=2, рекомендации - {'item_id_2': [33814431, 33773619, 34902408, 33284670, 33441288], 'score': [0.8976537585258484, 0.8937565088272095, 0.8891529440879822, 0.8861421942710876, 0.8780776262283325]}
2025-09-22 08:47:58,528 INFO - для каждого item_id=597280 получаем список похожих в item_similar_items
2025-09-22 08:47:58,528 INFO - оправляем запрос на сервер off-line рекомендаций http://127.0.0.1:8081 
   c параметрами: {'item_id': 597280, 'k': 100}
2025-09-22 08:47:58,529 DEBUG Starting new HTTP connection (1): 127.0.0.1:8081
2025-09-22 08:47:58,536 DEBUG http://127.0.0.1:8081 "POST /similar_items?item_id=597280&k=100 HTTP/1.1" 200 161
2025-09-22 08:47:58,537 INFO - ответ сервера off-line рекомендаций: количество=2, рекомендации - {'item_id_2': [19799170, 42590293, 25599862, 19799158, 597267], 'score': [0.9170520305633545, 0.9147616624832153, 0.911059558391571, 0.908427357673645, 0.9072427153587341]}
2025-09-22 08:47:58,537 INFO - сортируем похожие объекты по scores в убывающем порядке
2025-09-22 08:47:58,537 INFO    результат: [19799170, 42590293, 25599862, 19799158, 597267, 33814431, 33773619, 34902408, 33284670, 33441288]
2025-09-22 08:47:58,537 INFO - удаляем дубликаты, чтобы не выдавать одинаковые рекомендации
2025-09-22 08:47:58,537 INFO Дедублицируем список идентификаторов, оставляя только первое вхождение
2025-09-22 08:47:58,537 INFO    результат: [19799170, 42590293, 25599862, 19799158, 597267, 33814431, 33773619, 34902408, 33284670, 33441288]
2025-09-22 08:48:25,984 INFO Возвращаем список all рекомендаций длиной 100 для пользователя 1291250:
2025-09-22 08:48:25,984 INFO - получение списока off-line рекомендаций длиной 100 для пользователя 1291250
2025-09-22 08:48:25,984 INFO Возвращаем список off-line рекомендаций длиной 100 для пользователя 1291250
2025-09-22 08:48:26,307 INFO Off-line рекомендации: [53404, 33311009, 178529, 35505245, 24692821, 795836, 6705392, 32947997, 37384, 45499814, 51241318, 29544272, 39257277, 2758009, 65851540, 328683, 60292250, 17079396, 47627256, 51516485, 18385776, 23559960, 48951, 49961817, 57921154, 54798445, 29611476, 43942453, 34976783, 50685843, 29569939, 148345, 39946957, 56204557, 52380688, 21519270, 732401, 44184116, 137670, 694683, 17902234, 3703085, 48591706, 178495, 52100, 631623, 1710811, 39089632, 9047114, 6679078, 55561798, 37258117, 560473, 595258, 3581309, 24663745, 78426489, 33977439, 50834580, 61565558, 38275100, 580880, 16298499, 42197229, 56920241, 76434671, 628320, 83063895, 28036311, 58515506, 81848875, 25995209, 2278985, 10216, 66322065, 3616433, 34735046, 33308946, 628970, 43052381, 39307896, 44279380, 560468, 57799893, 765627, 56920237, 27032843, 9282507, 630670, 2192826, 62352387, 1710810, 56776952, 43731470, 50821247, 68562711, 75944934, 75642961, 29175370, 68348389]
2025-09-22 08:48:26,307 INFO - получение списока on-line рекомендаций длиной 100 для пользователя 1291250
2025-09-22 08:48:26,307 INFO Возвращаем список on-line рекомендаций длиной 100 для пользователя 1291250
2025-09-22 08:48:26,307 INFO - получаем последнее 100 событий пользователя 1291250
2025-09-22 08:48:26,307 INFO - оправляем запрос на сервер on-line рекомендаций http://127.0.0.1:8082 
   c параметрами: {'user_id': 1291250, 'k': 100}
2025-09-22 08:48:26,308 DEBUG Starting new HTTP connection (1): 127.0.0.1:8082
2025-09-22 08:48:26,310 DEBUG http://127.0.0.1:8082 "POST /get?user_id=1291250&k=100 HTTP/1.1" 200 28
2025-09-22 08:48:26,310 INFO - ответ сервера on-line рекомендаций: количество=2, рекомендации - [34308497, 597280]
2025-09-22 08:48:26,310 INFO Получаем список айтемов, похожих на последние 100, с которыми взаимодействовал пользователь:
2025-09-22 08:48:26,310 INFO - для каждого item_id=34308497 получаем список похожих в item_similar_items
2025-09-22 08:48:26,310 INFO - оправляем запрос на сервер off-line рекомендаций http://127.0.0.1:8081 
   c параметрами: {'item_id': 34308497, 'k': 100}
2025-09-22 08:48:26,311 DEBUG Starting new HTTP connection (1): 127.0.0.1:8081
2025-09-22 08:48:26,320 DEBUG http://127.0.0.1:8081 "POST /similar_items?item_id=34308497&k=100 HTTP/1.1" 200 165
2025-09-22 08:48:26,320 INFO - ответ сервера off-line рекомендаций: количество=2, рекомендации - {'item_id_2': [33814431, 33773619, 34902408, 33284670, 33441288], 'score': [0.8976537585258484, 0.8937565088272095, 0.8891529440879822, 0.8861421942710876, 0.8780776262283325]}
2025-09-22 08:48:26,320 INFO - для каждого item_id=597280 получаем список похожих в item_similar_items
2025-09-22 08:48:26,320 INFO - оправляем запрос на сервер off-line рекомендаций http://127.0.0.1:8081 
   c параметрами: {'item_id': 597280, 'k': 100}
2025-09-22 08:48:26,321 DEBUG Starting new HTTP connection (1): 127.0.0.1:8081
2025-09-22 08:48:26,329 DEBUG http://127.0.0.1:8081 "POST /similar_items?item_id=597280&k=100 HTTP/1.1" 200 161
2025-09-22 08:48:26,330 INFO - ответ сервера off-line рекомендаций: количество=2, рекомендации - {'item_id_2': [19799170, 42590293, 25599862, 19799158, 597267], 'score': [0.9170520305633545, 0.9147616624832153, 0.911059558391571, 0.908427357673645, 0.9072427153587341]}
2025-09-22 08:48:26,330 INFO - сортируем похожие объекты по scores в убывающем порядке
2025-09-22 08:48:26,330 INFO    результат: [19799170, 42590293, 25599862, 19799158, 597267, 33814431, 33773619, 34902408, 33284670, 33441288]
2025-09-22 08:48:26,330 INFO - удаляем дубликаты, чтобы не выдавать одинаковые рекомендации
2025-09-22 08:48:26,330 INFO Дедублицируем список идентификаторов, оставляя только первое вхождение
2025-09-22 08:48:26,330 INFO    результат: [19799170, 42590293, 25599862, 19799158, 597267, 33814431, 33773619, 34902408, 33284670, 33441288]
2025-09-22 08:48:26,330 INFO User 1291250: получено 10 онлайн и 100 офлайн рекомендаций
2025-09-22 08:48:26,330 INFO - чередуем элементы из списков, пока позволяет минимальная длина 10
2025-09-22 08:48:26,330 INFO /n[19799170, 53404, 42590293, 33311009, 25599862, 178529, 19799158, 35505245, 597267, 24692821, 33814431, 795836, 33773619, 6705392, 34902408, 32947997, 33284670, 37384, 33441288, 45499814]
2025-09-22 08:48:26,330 INFO - добавляем оставшиеся элементы в конец
2025-09-22 08:48:26,331 INFO /n[19799170, 53404, 42590293, 33311009, 25599862, 178529, 19799158, 35505245, 597267, 24692821, 33814431, 795836, 33773619, 6705392, 34902408, 32947997, 33284670, 37384, 33441288, 45499814, 51241318, 29544272, 39257277, 2758009, 65851540, 328683, 60292250, 17079396, 47627256, 51516485, 18385776, 23559960, 48951, 49961817, 57921154, 54798445, 29611476, 43942453, 34976783, 50685843, 29569939, 148345, 39946957, 56204557, 52380688, 21519270, 732401, 44184116, 137670, 694683, 17902234, 3703085, 48591706, 178495, 52100, 631623, 1710811, 39089632, 9047114, 6679078, 55561798, 37258117, 560473, 595258, 3581309, 24663745, 78426489, 33977439, 50834580, 61565558, 38275100, 580880, 16298499, 42197229, 56920241, 76434671, 628320, 83063895, 28036311, 58515506, 81848875, 25995209, 2278985, 10216, 66322065, 3616433, 34735046, 33308946, 628970, 43052381, 39307896, 44279380, 560468, 57799893, 765627, 56920237, 27032843, 9282507, 630670, 2192826, 62352387, 1710810, 56776952, 43731470, 50821247, 68562711, 75944934, 75642961, 29175370, 68348389]
2025-09-22 08:48:26,331 INFO - удаляем дубликаты
2025-09-22 08:48:26,331 INFO Дедублицируем список идентификаторов, оставляя только первое вхождение
2025-09-22 08:48:26,331 INFO /n[19799170, 53404, 42590293, 33311009, 25599862, 178529, 19799158, 35505245, 597267, 24692821, 33814431, 795836, 33773619, 6705392, 34902408, 32947997, 33284670, 37384, 33441288, 45499814, 51241318, 29544272, 39257277, 2758009, 65851540, 328683, 60292250, 17079396, 47627256, 51516485, 18385776, 23559960, 48951, 49961817, 57921154, 54798445, 29611476, 43942453, 34976783, 50685843, 29569939, 148345, 39946957, 56204557, 52380688, 21519270, 732401, 44184116, 137670, 694683, 17902234, 3703085, 48591706, 178495, 52100, 631623, 1710811, 39089632, 9047114, 6679078, 55561798, 37258117, 560473, 595258, 3581309, 24663745, 78426489, 33977439, 50834580, 61565558, 38275100, 580880, 16298499, 42197229, 56920241, 76434671, 628320, 83063895, 28036311, 58515506, 81848875, 25995209, 2278985, 10216, 66322065, 3616433, 34735046, 33308946, 628970, 43052381, 39307896, 44279380, 560468, 57799893, 765627, 56920237, 27032843, 9282507, 630670, 2192826, 62352387, 1710810, 56776952, 43731470, 50821247, 68562711, 75944934, 75642961, 29175370, 68348389]
2025-09-22 08:48:26,331 INFO - оставляем только первые k рекомендаций
2025-09-22 08:48:26,331 INFO /n[19799170, 53404, 42590293, 33311009, 25599862, 178529, 19799158, 35505245, 597267, 24692821, 33814431, 795836, 33773619, 6705392, 34902408, 32947997, 33284670, 37384, 33441288, 45499814, 51241318, 29544272, 39257277, 2758009, 65851540, 328683, 60292250, 17079396, 47627256, 51516485, 18385776, 23559960, 48951, 49961817, 57921154, 54798445, 29611476, 43942453, 34976783, 50685843, 29569939, 148345, 39946957, 56204557, 52380688, 21519270, 732401, 44184116, 137670, 694683, 17902234, 3703085, 48591706, 178495, 52100, 631623, 1710811, 39089632, 9047114, 6679078, 55561798, 37258117, 560473, 595258, 3581309, 24663745, 78426489, 33977439, 50834580, 61565558, 38275100, 580880, 16298499, 42197229, 56920241, 76434671, 628320, 83063895, 28036311, 58515506, 81848875, 25995209, 2278985, 10216, 66322065, 3616433, 34735046, 33308946, 628970, 43052381, 39307896, 44279380, 560468, 57799893, 765627, 56920237, 27032843, 9282507, 630670, 2192826]
